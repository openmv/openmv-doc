<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>class PWM – pulse width modulation &mdash; MicroPython 1.20 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d5a28fe3" />
      <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />

  
    <link rel="shortcut icon" href="../_static/openmv.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=6b422e2e"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="class UART – duplex serial communication bus" href="machine.UART.html" />
    <link rel="prev" title="class ADCBlock – control ADC peripherals" href="machine.ADCBlock.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MicroPython
              <img src="../_static/web-logo-sticky.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.20
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MicroPython libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#python-standard-libraries-and-micro-libraries">Python standard libraries and micro-libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#micropython-specific-libraries">MicroPython-specific libraries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="bluetooth.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bluetooth</span></code> — low-level Bluetooth</a></li>
<li class="toctree-l3"><a class="reference internal" href="btree.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">btree</span></code> – simple BTree database</a></li>
<li class="toctree-l3"><a class="reference internal" href="cryptolib.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cryptolib</span></code> – cryptographic ciphers</a></li>
<li class="toctree-l3"><a class="reference internal" href="framebuf.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">framebuf</span></code> — frame buffer manipulation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="machine.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">machine</span></code> — functions related to the hardware</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="machine.html#memory-access">Memory access</a></li>
<li class="toctree-l4"><a class="reference internal" href="machine.html#reset-related-functions">Reset related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="machine.html#interrupt-related-functions">Interrupt related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="machine.html#power-related-functions">Power related functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="machine.html#miscellaneous-functions">Miscellaneous functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="machine.html#constants">Constants</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="machine.html#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="micropython.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">micropython</span></code> – access and control MicroPython internals</a></li>
<li class="toctree-l3"><a class="reference internal" href="neopixel.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neopixel</span></code> — control of WS2812 / NeoPixel LEDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="network.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">network</span></code> — network configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="uctypes.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">uctypes</span></code> – access binary data in a structured way</a></li>
<li class="toctree-l3"><a class="reference internal" href="mutex.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mutex</span></code> — mutex module</a></li>
<li class="toctree-l3"><a class="reference internal" href="uping.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">uping</span></code> — Ping another computer</a></li>
<li class="toctree-l3"><a class="reference internal" href="urequests.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">urequests</span></code> — Related functions of HTTP client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#libraries-specific-to-the-openmv-cam">Libraries specific to the OpenMV Cam</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#third-party-libraries-on-the-openmv-cam">Third-party libraries on the OpenMV Cam</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#extending-built-in-libraries-from-python">Extending built-in libraries from Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">MicroPython language and implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython license information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/quickref.html">Quick reference for the openmvcam</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">MicroPython libraries</a></li>
          <li class="breadcrumb-item"><a href="machine.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">machine</span></code> — functions related to the hardware</a></li>
      <li class="breadcrumb-item active">class PWM – pulse width modulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/library/machine.PWM.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="class-pwm-pulse-width-modulation">
<span id="machine-pwm"></span><h1>class PWM – pulse width modulation<a class="headerlink" href="#class-pwm-pulse-width-modulation" title="Permalink to this heading">¶</a></h1>
<p>This class provides pulse width modulation output.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">PWM</span>

<span class="n">pwm</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span>          <span class="c1"># create a PWM object on a pin</span>
<span class="n">pwm</span><span class="o">.</span><span class="n">duty_u16</span><span class="p">(</span><span class="mi">32768</span><span class="p">)</span>     <span class="c1"># set duty to 50%</span>

<span class="c1"># reinitialise with a period of 200us, duty of 5us</span>
<span class="n">pwm</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">duty_ns</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">pwm</span><span class="o">.</span><span class="n">duty_ns</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>       <span class="c1"># set pulse width to 3us</span>

<span class="n">pwm</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
<section id="constructors">
<h2>Constructors<a class="headerlink" href="#constructors" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="machine.PWM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">machine.</span></span><span class="sig-name descname"><span class="pre">PWM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duty_u16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duty_ns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct and return a new PWM object using the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>dest</em> is the entity on which the PWM is output, which is usually a
<a class="reference internal" href="machine.Pin.html#machine-pin"><span class="std std-ref">machine.Pin</span></a> object, but a port may allow other values,
like integers.</p></li>
<li><p><em>freq</em> should be an integer which sets the frequency in Hz for the
PWM cycle.</p></li>
<li><p><em>duty_u16</em> sets the duty cycle as a ratio <code class="docutils literal notranslate"><span class="pre">duty_u16</span> <span class="pre">/</span> <span class="pre">65535</span></code>.</p></li>
<li><p><em>duty_ns</em> sets the pulse width in nanoseconds.</p></li>
</ul>
</div></blockquote>
<p>Setting <em>freq</em> may affect other PWM objects if the objects share the same
underlying PWM generator (this is hardware specific).
Only one of <em>duty_u16</em> and <em>duty_ns</em> should be specified at a time.</p>
</dd></dl>

</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="machine.PWM.init">
<span class="sig-prename descclassname"><span class="pre">PWM.</span></span><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duty_u16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duty_ns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify settings for the PWM object.  See the above constructor for details
about the parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="machine.PWM.deinit">
<span class="sig-prename descclassname"><span class="pre">PWM.</span></span><span class="sig-name descname"><span class="pre">deinit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM.deinit" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable the PWM output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="machine.PWM.freq">
<span class="sig-prename descclassname"><span class="pre">PWM.</span></span><span class="sig-name descname"><span class="pre">freq</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM.freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the current frequency of the PWM output.</p>
<p>With no arguments the frequency in Hz is returned.</p>
<p>With a single <em>value</em> argument the frequency is set to that value in Hz.  The
method may raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if the frequency is outside the valid range.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="machine.PWM.duty_u16">
<span class="sig-prename descclassname"><span class="pre">PWM.</span></span><span class="sig-name descname"><span class="pre">duty_u16</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM.duty_u16" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the current duty cycle of the PWM output, as an unsigned 16-bit
value in the range 0 to 65535 inclusive.</p>
<p>With no arguments the duty cycle is returned.</p>
<p>With a single <em>value</em> argument the duty cycle is set to that value, measured
as the ratio <code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">/</span> <span class="pre">65535</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="machine.PWM.duty_ns">
<span class="sig-prename descclassname"><span class="pre">PWM.</span></span><span class="sig-name descname"><span class="pre">duty_ns</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.PWM.duty_ns" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the current pulse width of the PWM output, as a value in nanoseconds.</p>
<p>With no arguments the pulse width in nanoseconds is returned.</p>
<p>With a single <em>value</em> argument the pulse width is set to that value.</p>
</dd></dl>

</section>
<section id="specific-pwm-class-implementations">
<h2>Specific PWM class implementations<a class="headerlink" href="#specific-pwm-class-implementations" title="Permalink to this heading">¶</a></h2>
<p>The following concrete class(es) implement enhancements to the PWM class.</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="pyb.Timer.html#pyb-timer"><span class="std std-ref">pyb.Timer for PyBoard</span></a></div>
</div>
</div></blockquote>
</section>
<section id="limitations-of-pwm">
<h2>Limitations of PWM<a class="headerlink" href="#limitations-of-pwm" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>Not all frequencies can be generated with absolute accuracy due to
the discrete nature of the computing hardware.  Typically the PWM frequency
is obtained by dividing some integer base frequency by an integer divider.
For example, if the base frequency is 80MHz and the required PWM frequency is
300kHz the divider must be a non-integer number 80000000 / 300000 = 266.67.
After rounding the divider is set to 267 and the PWM frequency will be
80000000 / 267 = 299625.5 Hz, not 300kHz.  If the divider is set to 266 then
the PWM frequency will be 80000000 / 266 = 300751.9 Hz, but again not 300kHz.</p>
<p>Some ports like the RP2040 one use a fractional divider, which allow a finer
granularity of the frequency at higher frequencies by switching the PWM
pulse duration between two adjacent values, such that the resulting average
frequency is more close to the intended one, at the cost of spectral purity.</p>
</li>
<li><p>The duty cycle has the same discrete nature and its absolute accuracy is not
achievable.  On most hardware platforms the duty will be applied at the next
frequency period.  Therefore, you should wait more than “1/frequency” before
measuring the duty.</p></li>
<li><p>The frequency and the duty cycle resolution are usually interdependent.
The higher the PWM frequency the lower the duty resolution which is available,
and vice versa. For example, a 300kHz PWM frequency can have a duty cycle
resolution of 8 bit, not 16-bit as may be expected.  In this case, the lowest
8 bits of <em>duty_u16</em> are insignificant. So:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pwm</span><span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="mi">300_000</span><span class="p">,</span> <span class="n">duty_u16</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pwm</span><span class="o">=</span><span class="n">PWM</span><span class="p">(</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="mi">300_000</span><span class="p">,</span> <span class="n">duty_u16</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">16</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">255</span><span class="p">)</span>
</pre></div>
</div>
<p>will generate PWM with the same 50% duty cycle.</p>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="machine.ADCBlock.html" class="btn btn-neutral float-left" title="class ADCBlock – control ADC peripherals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="machine.UART.html" class="btn btn-neutral float-right" title="class UART – duplex serial communication bus" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright - The MicroPython Documentation is Copyright © 2014-2023, Damien P. George, Paul Sokolovsky, and contributors.
      <span class="lastupdated">Last updated on 01 Dec 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Language and External Links</span>
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Language</dt>
      <dd>
        <a href="https://openmv.io">English</a>
      </dd>
      <dd>
        <a href="http://doc.singtown.cc">中文</a>
      </dd>
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
      <dd>
        <a href="https://openmv.io">openmv.io</a>
      </dd>
      <dd>
        <a href="http://forums.openmv.io">forums.openmv.io</a>
      </dd>
      <dd>
        <a href="https://github.com/openmv/openmv">github.com/openmv/openmv</a>
      </dd>
      <dd>
        <a href="http://micropython.org">micropython.org</a>
      </dd>
      <dd>
        <a href="http://forum.micropython.org">forum.micropython.org</a>
      </dd>
      <dd>
        <a href="https://github.com/micropython/micropython">github.com/micropython/micropython</a>
      </dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>