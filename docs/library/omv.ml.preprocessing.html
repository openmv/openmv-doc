<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ml.preprocessing — ML Preprocessing &mdash; MicroPython 1.23 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d5a28fe3" />
      <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />

  
    <link rel="shortcut icon" href="../_static/openmv.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=5cbaa444"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ml.utils — ML Utils" href="omv.ml.utils.html" />
    <link rel="prev" title="ml.apps — ML Apps" href="omv.ml.apps.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MicroPython
              <img src="../_static/web-logo-sticky.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.23
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MicroPython libraries</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#python-standard-libraries-and-micro-libraries">Python standard libraries and micro-libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#micropython-specific-libraries">MicroPython-specific libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#libraries-specific-to-the-openmv-cam">Libraries specific to the OpenMV Cam</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pyb.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyb</span></code> — functions related to the board</a></li>
<li class="toctree-l3"><a class="reference internal" href="stm.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stm</span></code> — functionality specific to STM32 MCUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.sensor.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sensor</span></code> — camera sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.image.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">image</span></code> — machine vision</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="omv.ml.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ml</span></code> — Machine Learning</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="omv.ml.html#sub-modules">Sub Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="omv.ml.html#class-model-model-container">class model – Model Container</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="omv.gif.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gif</span></code> — gif recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.mjpeg.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mjpeg</span></code> — mjpeg recording</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.audio.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">audio</span></code> — Audio Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.display.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">display</span></code> — display driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.fir.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fir</span></code> — thermal sensor driver (fir == far infrared)</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.tv.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tv</span></code> — tv shield driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.cpufreq.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cpufreq</span></code> — CPU Frequency Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.buzzer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">buzzer</span></code> — buzzer driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.imu.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">imu</span></code> — imu sensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.rpc.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rpc</span></code> — rpc library</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.rtsp.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rtsp</span></code> — rtsp library</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.omv.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">omv</span></code> — OpenMV Cam Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.gt911.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gt911</span></code> — Touch Screen Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.ft5x06.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ft5x06</span></code> — Touch Screen Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="omv.tfp410.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tfp410</span></code> — DVI/HDMI Controller</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#third-party-libraries-on-the-openmv-cam">Third-party libraries on the OpenMV Cam</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#extending-built-in-libraries-from-python">Extending built-in libraries from Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">MicroPython language and implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython license information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/quickref.html">Quick reference for the openmvcam</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">MicroPython libraries</a></li>
          <li class="breadcrumb-item"><a href="omv.ml.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ml</span></code> — Machine Learning</a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ml.preprocessing</span></code> — ML Preprocessing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/library/omv.ml.preprocessing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ml.preprocessing">
<span id="ml-preprocessing-ml-preprocessing"></span><h1><a class="reference internal" href="#module-ml.preprocessing" title="ml.preprocessing: ML Preprocessing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ml.preprocessing</span></code></a> — ML Preprocessing<a class="headerlink" href="#module-ml.preprocessing" title="Permalink to this heading">¶</a></h1>
<p>The <a class="reference internal" href="#module-ml.preprocessing" title="ml.preprocessing: ML Preprocessing"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">ml.preprocessing</span></code></a> module contains classes for preprocessing images for use with machine learning models.</p>
<section id="class-normalization-image-normalization">
<span id="preprocessing-normalization"></span><h2>class Normalization – Image Normalization<a class="headerlink" href="#class-normalization-image-normalization" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="#ml.preprocessing.Normalization" title="ml.preprocessing.Normalization"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Normalization</span></code></a> object is used to convert image objects to numpy <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> objects for use with the <a class="reference internal" href="omv.ml.html#ml.Model" title="ml.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object.
It’s automatically created by the <a class="reference internal" href="omv.ml.html#ml.Model" title="ml.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> object when an image object is passed to <a class="reference internal" href="omv.ml.html#ml.Model.predict" title="ml.Model.predict"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a>. However,
you can also manually create a <a class="reference internal" href="#ml.preprocessing.Normalization" title="ml.preprocessing.Normalization"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Normalization</span></code></a> object to control the conversion process, select an ROI, etc.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;model.tflite&quot;</span><span class="p">)</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">Normalization</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">),</span> <span class="n">stdev</span><span class="o">=</span><span class="p">(</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">))</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">norm</span><span class="p">(</span><span class="n">image</span><span class="p">)])</span>
</pre></div>
</div>
<section id="constructors">
<h3>Constructors<a class="headerlink" href="#constructors" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="ml.preprocessing.Normalization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ml.preprocessing.</span></span><span class="sig-name descname"><span class="pre">Normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="builtins.html#tuple" title="tuple"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="builtins.html#tuple" title="tuple"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="builtins.html#tuple" title="tuple"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#float" title="float"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="builtins.html#tuple" title="tuple"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="builtins.html#int" title="int"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#int" title="int"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#int" title="int"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="builtins.html#int" title="int"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#ml.preprocessing.Normalization" title="ml.preprocessing.Normalization"><span class="pre">Normalization</span></a></span></span><a class="headerlink" href="#ml.preprocessing.Normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="#ml.preprocessing.Normalization" title="ml.preprocessing.Normalization"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Normalization</span></code></a> object which is used to convert image objects to numpy arrays for use with the
<a class="reference internal" href="omv.ml.html#ml.Model.predict" title="ml.Model.predict"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">predict()</span></code></a>. The object can also be used to select a region of interest (ROI) in the image to
convert to a numpy array.</p>
<p>The Normalization object automatically converts any image type passed (including compressed images)
into either a single channel (grayscale) or three channel (RGB888) image which is passed to the tensor
input of the model. Images are centered, scaled up/down (using bilinear/area scaling), and cropped as
necessary to match the input tensor size of the model.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">uint8</span></code> input tensors the image is directly passed ignoring scale and mean/stdev. For <code class="docutils literal notranslate"><span class="pre">int8</span></code>
input tensors the image is shifted to be within the <code class="docutils literal notranslate"><span class="pre">int8</span></code> range from the <code class="docutils literal notranslate"><span class="pre">uint8</span></code> range and
then directly passed ignoring scale and mean/stdev. Tensors that accept either of these formats
can be processed more quickly than tensors that require floating point inputs.</p>
<p>For floating point input tensors it’s not possible to guess the correct range that the model
expects. While each input tensor encodes a scale and zero point value that can be used to
convert the input to the correct range, these values do not tell you what the range
of the input data should be in floating point. E.g. should image RGB values be within the range
of (0.0, 1.0), (-1.0, 1.0), (0.0, 255.0), and etc. before applying a scale and zero point? The
answer is that it depends on the model and how it was trained. So, the normalization object instead
allows you to directly specify the range of the input data, the mean, and the standard deviation. The
Grayscale or RGB88 image is then converted into a floating point tensor for the model to process
based on these values.</p>
<p>uint16 and int16 input tensors are not supported.</p>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="omv.ml.apps.html" class="btn btn-neutral float-left" title="ml.apps — ML Apps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="omv.ml.utils.html" class="btn btn-neutral float-right" title="ml.utils — ML Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright - The MicroPython Documentation is Copyright © 2014-2024, Damien P. George, Paul Sokolovsky, and contributors.
      <span class="lastupdated">Last updated on 05 Sep 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Language and External Links</span>
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Language</dt>
      <dd>
        <a href="https://openmv.io">English</a>
      </dd>
      <dd>
        <a href="http://doc.singtown.cc">中文</a>
      </dd>
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
      <dd>
        <a href="https://openmv.io">openmv.io</a>
      </dd>
      <dd>
        <a href="http://forums.openmv.io">forums.openmv.io</a>
      </dd>
      <dd>
        <a href="https://github.com/openmv/openmv">github.com/openmv/openmv</a>
      </dd>
      <dd>
        <a href="http://micropython.org">micropython.org</a>
      </dd>
      <dd>
        <a href="http://forum.micropython.org">forum.micropython.org</a>
      </dd>
      <dd>
        <a href="https://github.com/micropython/micropython">github.com/micropython/micropython</a>
      </dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>