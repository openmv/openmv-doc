<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. Branch instructions &mdash; MicroPython 1.19 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/openmv.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Stack push and pop" href="asm_thumb2_stack.html" />
    <link rel="prev" title="6. Comparison instructions" href="asm_thumb2_compare.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MicroPython
              <img src="../_static/web-logo-sticky.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.19
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">MicroPython libraries</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">MicroPython language and implementation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="repl.html">The MicroPython Interactive Interpreter Mode (aka REPL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpremote.html">MicroPython remote control: mpremote</a></li>
<li class="toctree-l2"><a class="reference internal" href="mpyfiles.html">MicroPython .mpy files</a></li>
<li class="toctree-l2"><a class="reference internal" href="isr_rules.html">Writing interrupt handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="speed_python.html">Maximising MicroPython speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="constrained.html">MicroPython on microcontrollers</a></li>
<li class="toctree-l2"><a class="reference internal" href="manifest.html">MicroPython manifest files</a></li>
<li class="toctree-l2"><a class="reference internal" href="packages.html">Package management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="asm_thumb2_index.html">Inline assembler for Thumb2 architectures</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="asm_thumb2_index.html#document-conventions">Document conventions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="asm_thumb2_index.html#instruction-categories">Instruction categories</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_mov.html">1. Register move instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_ldr.html">2. Load register from memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_str.html">3. Store register to memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_logical_bit.html">4. Logical &amp; bitwise instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_arith.html">5. Arithmetic instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_compare.html">6. Comparison instructions</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">7. Branch instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_stack.html">8. Stack push and pop</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_misc.html">9. Miscellaneous instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_float.html">10. Floating point instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="asm_thumb2_directives.html">11. Assembler directives</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="asm_thumb2_index.html#usage-examples">Usage examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="asm_thumb2_index.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="filesystem.html">Working with filesystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyboard.py.html">The pyboard.py tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython license information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openmvcam/quickref.html">Quick reference for the openmvcam</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">MicroPython language and implementation</a></li>
          <li class="breadcrumb-item"><a href="asm_thumb2_index.html">Inline assembler for Thumb2 architectures</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7. </span>Branch instructions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/asm_thumb2_label_branch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="branch-instructions">
<h1><span class="section-number">7. </span>Branch instructions<a class="headerlink" href="#branch-instructions" title="Permalink to this heading">¶</a></h1>
<p>These cause execution to jump to a target location usually specified by a label (see the <code class="docutils literal notranslate"><span class="pre">label</span></code>
assembler directive). Conditional branches and the <code class="docutils literal notranslate"><span class="pre">it</span></code> and <code class="docutils literal notranslate"><span class="pre">ite</span></code> instructions test
the Application Program Status Register (APSR) N (negative), Z (zero), C (carry) and V
(overflow) flags to determine whether the branch should be executed.</p>
<p>Most of the exposed assembler instructions (including move operations) set the flags but
there are explicit comparison instructions to enable values to be tested.</p>
<p>Further detail on the meaning of the condition flags is provided in the section
describing comparison functions.</p>
<section id="document-conventions">
<h2><span class="section-number">7.1. </span>Document conventions<a class="headerlink" href="#document-conventions" title="Permalink to this heading">¶</a></h2>
<p>Notation: <code class="docutils literal notranslate"><span class="pre">Rm</span></code> denotes ARM registers R0-R15. <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> denotes a label defined with the
<code class="docutils literal notranslate"><span class="pre">label()</span></code> assembler directive. <code class="docutils literal notranslate"><span class="pre">&lt;condition&gt;</span></code> indicates one of the following condition
specifiers:</p>
<ul class="simple">
<li><p>eq Equal to (result was zero)</p></li>
<li><p>ne Not equal</p></li>
<li><p>cs Carry set</p></li>
<li><p>cc Carry clear</p></li>
<li><p>mi Minus (negative)</p></li>
<li><p>pl Plus (positive)</p></li>
<li><p>vs Overflow set</p></li>
<li><p>vc Overflow clear</p></li>
<li><p>hi &gt; (unsigned comparison)</p></li>
<li><p>ls &lt;= (unsigned comparison)</p></li>
<li><p>ge &gt;= (signed comparison)</p></li>
<li><p>lt &lt; (signed comparison)</p></li>
<li><p>gt &gt; (signed comparison)</p></li>
<li><p>le &lt;= (signed comparison)</p></li>
</ul>
</section>
<section id="branch-to-label">
<h2><span class="section-number">7.2. </span>Branch to label<a class="headerlink" href="#branch-to-label" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>b(LABEL) Unconditional branch</p></li>
<li><p>beq(LABEL) branch if equal</p></li>
<li><p>bne(LABEL) branch if not equal</p></li>
<li><p>bge(LABEL) branch if greater than or equal</p></li>
<li><p>bgt(LABEL) branch if greater than</p></li>
<li><p>blt(LABEL) branch if less than (&lt;) (signed)</p></li>
<li><p>ble(LABEL) branch if less than or equal to (&lt;=) (signed)</p></li>
<li><p>bcs(LABEL) branch if carry flag is set</p></li>
<li><p>bcc(LABEL) branch if carry flag is clear</p></li>
<li><p>bmi(LABEL) branch if negative</p></li>
<li><p>bpl(LABEL) branch if positive</p></li>
<li><p>bvs(LABEL) branch if overflow flag set</p></li>
<li><p>bvc(LABEL) branch if overflow flag is clear</p></li>
<li><p>bhi(LABEL) branch if higher (unsigned)</p></li>
<li><p>bls(LABEL) branch if lower or equal (unsigned)</p></li>
</ul>
</section>
<section id="long-branches">
<h2><span class="section-number">7.3. </span>Long branches<a class="headerlink" href="#long-branches" title="Permalink to this heading">¶</a></h2>
<p>The code produced by the branch instructions listed above uses a fixed bit width to specify the
branch destination, which is PC relative. Consequently in long programs where the
branch instruction is remote from its destination the assembler will produce a “branch not in
range” error. This can be overcome with the “wide” variants such as</p>
<ul class="simple">
<li><p>beq_w(LABEL) long branch if equal</p></li>
</ul>
<p>Wide branches use 4 bytes to encode the instruction (compared with 2 bytes for standard branch instructions).</p>
</section>
<section id="subroutines-functions">
<h2><span class="section-number">7.4. </span>Subroutines (functions)<a class="headerlink" href="#subroutines-functions" title="Permalink to this heading">¶</a></h2>
<p>When entering a subroutine the processor stores the return address in register r14, also
known as the link register (lr). Return to the instruction after the subroutine call is
performed by updating the program counter (r15 or pc) from the link register, This
process is handled by the following instructions.</p>
<ul class="simple">
<li><p>bl(LABEL)</p></li>
</ul>
<p>Transfer execution to the instruction after <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> storing the return address in
the link register (r14).</p>
<ul class="simple">
<li><p>bx(Rm) Branch to address specified by Rm.</p></li>
</ul>
<p>Typically <code class="docutils literal notranslate"><span class="pre">bx(lr)</span></code> is issued to return from a subroutine. For nested subroutines the
link register of outer scopes must be saved (usually on the stack) before performing
inner subroutine calls.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="asm_thumb2_compare.html" class="btn btn-neutral float-left" title="6. Comparison instructions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="asm_thumb2_stack.html" class="btn btn-neutral float-right" title="8. Stack push and pop" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright - The MicroPython Documentation is Copyright © 2014-2023, Damien P. George, Paul Sokolovsky, and contributors.
      <span class="lastupdated">Last updated on 02 May 2023.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Language and External Links</span>
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Language</dt>
      <dd>
        <a href="https://openmv.io">English</a>
      </dd>
      <dd>
        <a href="http://doc.singtown.cc">中文</a>
      </dd>
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
      <dd>
        <a href="https://openmv.io">openmv.io</a>
      </dd>
      <dd>
        <a href="http://forums.openmv.io">forums.openmv.io</a>
      </dd>
      <dd>
        <a href="https://github.com/openmv/openmv">github.com/openmv/openmv</a>
      </dd>
      <dd>
        <a href="http://micropython.org">micropython.org</a>
      </dd>
      <dd>
        <a href="http://forum.micropython.org">forum.micropython.org</a>
      </dd>
      <dd>
        <a href="https://github.com/micropython/micropython">github.com/micropython/micropython</a>
      </dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>